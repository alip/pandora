/* vim: set et sw=4 sts=4 ft=javascript : */

{
    "core" :
        { "log"       : { "fd"    : 2
                        , "file"  : ""
                        , "level" : 2
                        },
        , "sandbox"   : { "exec" : false
                        , "path" : false
                        , "sock" : false
                        }
        , "allow"     : { "per_process_directories" : true
                        , "successful_bind"         : true
                        }
        , "panic"     : { "decision"  : "kill"
                        , "exit_code" : -1
                        }
        , "violation" : { "decision"    : "deny"
                        , "exit_code"   : -1
                        , "ignore_safe" : true
                        }
        , "trace"     : { "followfork"    : true
                        , "exit_wait_all" : true
                        , "magic_lock"    : "off"
                        }
        },

    "allow" :
        { "exec" : [ ]
        , "path" : [ "/dev/stdout"
                   , "/dev/stderr"
                   , "/dev/zero"
                   , "/dev/null"
                   , "/dev/full"
                   , "/dev/console"
                   , "/dev/random"
                   , "/dev/ptmx"
                   , "/dev/fd/***"
                   , "/dev/tty*"
                   , "/dev/pty*"
                   , "/dev/tts*"
                   , "/dev/pts*"
                   , "/proc/self/fd/***"
                   , "/dev/shm/***"
                   , "/selinux/context/***"
                   , "/proc/self/attr/***"
                   , "/proc/self/task/***"
                   , "/tmp/***"
                   , "/var/tmp/***"
                   , "/var/cache/***"
                   , "${CCACHE_DIR}/***"
                   , "${PALUDIS_TMPDIR}/***"
                   ]
        , "sock" :
            { "bind" : [ "LOOPBACK@0"
                       , "LOOPBACK@1024-65535"
                       , "LOOPBACK6@0"
                       , "LOOPBACK6@1024-65535"
                       ]
            , "connect" : [ "unix:/var/run/nscd/socket" ]
            }
        },

    "filter" :
        { "exec" : [ ]
        , "path" : [ ]
        , "sock" : [ ]
        }
}
